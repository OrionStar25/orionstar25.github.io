<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Let's hunt those Memory Leaks! | Niharika Shrivastava</title> <meta name="author" content="Niharika Shrivastava"> <meta name="description" content="I learn more when I make mistakes"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, niharika-shrivastava"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%98%AF%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://orionstar25.github.io/blog/2019/outreachy-week-3/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Niharika </span>Shrivastava</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">opensource</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/repositories/">github</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/presentations/">presentations</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/mentoring/">mentoring</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/checklist/">my dynamic checklist</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Let's hunt those Memory Leaks!</h1> <p class="post-meta">June 5, 2019</p> <p class="post-tags"> <a href="/blog/2019"> <i class="fa-solid fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/tag/open-source"> <i class="fa-solid fa-hashtag fa-sm"></i> open source</a>   <a href="/blog/tag/outreachy"> <i class="fa-solid fa-hashtag fa-sm"></i> outreachy</a>   <a href="/blog/tag/technology"> <i class="fa-solid fa-hashtag fa-sm"></i> technology</a>   <a href="/blog/tag/gsoc"> <i class="fa-solid fa-hashtag fa-sm"></i> gsoc</a>   <a href="/blog/tag/research"> <i class="fa-solid fa-hashtag fa-sm"></i> research</a>   <a href="/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> python</a>   <a href="/blog/tag/jekyll"> <i class="fa-solid fa-hashtag fa-sm"></i> jekyll</a>   <a href="/blog/tag/fedora"> <i class="fa-solid fa-hashtag fa-sm"></i> fedora</a>   <a href="/blog/tag/modularity"> <i class="fa-solid fa-hashtag fa-sm"></i> modularity</a>     ·   <a href="/blog/category/open-source"> <i class="fa-solid fa-tag fa-sm"></i> open-source</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>We’re into week 4 of Outreachy! And just when I thought I was <em>finally</em> getting the hang of Modularity’s codebase, I ran into something I’ve dreaded my entire life: Segmentation faults, runtime errors, AND MEMORY LEAKS!</p> <p>I do know that when we allocate memory for variables, we should free them after we’re done to avoid any memory leaks. You all might know already about the <strong>Automatic garbage collection in Java</strong></p> <blockquote> <p>Java Memory Management, with its built-in garbage collection, is one of the language’s finest achievements. It allows developers to create new objects without worrying explicitly about memory allocation and deallocation, because the garbage collector automatically reclaims memory for reuse.</p> </blockquote> <p>But this is not the case with Object C in which I was working on for a certain PR. So as a methodical approach, I initialized objects, and made sure they got dereferenced once they were out of scope. And then I ran the tests.</p> <h3 id="fail"><strong>FAIL</strong></h3> <p>I ran into a segmentation error I JUST COULDN’T TRACE! I ran certain tests individually. I ran a <code class="language-plaintext highlighter-rouge">GDB</code> debugger and traced, backtraced, checked my stack, added breakpoints, and possibly tried other <code class="language-plaintext highlighter-rouge">GDB</code> options, but all in vain! After possibly being stuck at this for about half a day, I turned to my mentor(Stephan) on IRC.</p> <p>Something that I must point out before I venture into what resources Stephan pointed me towards, that ultimately helped me solve this issue.</p> <ol> <li> <p>Asking doubts on IRC <strong>IS</strong> definitely intimidating. They’re usually public channels and the thought that someone might be silently judging me for asking stupid questions has crossed my mind a million times.</p> </li> <li> <p>But over the years, I’ve become a little less ashamed of what I don’t know, and ask because I’ll b receiving knowledge in return.</p> </li> <li> <p>But just sometimes, I ask questions in haste only to realize I knew the answer already. <em>hehe</em></p> </li> </ol> <p>Basically kids, ask your questions after you know you’ve thought through possible answers yourselves. No one in an open source community will ever deny you facts and resources. But if you ask your doubts with context to what you have tried, and eventually failed, others will know you’re genuinely trying to solve an issue.</p> <p>Anyway, I still feel my mentor is mini-Google and so I’m in luck (Thanks a lot, sir) :D</p> <h2 id="the-victim-pr">The victim PR</h2> <p>This PR made me understand the niti-gritties of memory management techniques: <a href="https://github.com/fedora-modularity/libmodulemd/pull/313" rel="external nofollow noopener" target="_blank">Add modulemd_get_stream_names()</a></p> <p>I was supposed to write a function that took a Modulemd.Module object as an input, and gave as output an ordered list of names of all the streams present in that module.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Iterate through all the streams <span class="k">in </span>module:
	Store each stream name <span class="k">in </span>a <span class="nb">set

</span>Sort <span class="nb">set </span>alphabetically
Return <span class="nb">set</span>	
</code></pre></div></div> <p>Streams are stored as a <code class="language-plaintext highlighter-rouge">GPtrArray</code> in a <code class="language-plaintext highlighter-rouge">module</code> object. The data structure needed for the <code class="language-plaintext highlighter-rouge">set()</code> as in the psuedocode was a <code class="language-plaintext highlighter-rouge">GHashtable</code>. This is so that this set can be fed into an ordering(sorting) function later.</p> <p>So I initialised a <code class="language-plaintext highlighter-rouge">GHashtable</code> with the name <code class="language-plaintext highlighter-rouge">stream_names</code>.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GHashtable <span class="k">*</span>stream_names <span class="o">=</span> NULL<span class="p">;</span>
</code></pre></div></div> <p>And there were two mistakes here:</p> <ol> <li>I created a pointer to <code class="language-plaintext highlighter-rouge">GHashtable</code>, and not the hash table itself. We can think of it as initializing an array in C, but not using <code class="language-plaintext highlighter-rouge">malloc()</code> to allocate memory for it.</li> <li>I never freed the hash table.</li> </ol> <h3 id="lesson-1">Lesson 1</h3> <ol> <li> <p><code class="language-plaintext highlighter-rouge">(transfer full)</code> on a container type (GPtrArray, GArray and GHashTable) tells the binding: “You are responsible for freeing the array container and all of its members”.</p> </li> <li> <p><code class="language-plaintext highlighter-rouge">(transfer container)</code> on a container type tells it: “You only need to free the container itself. The elements are handled elsewhere.”</p> </li> </ol> <p>So if I initialise a <code class="language-plaintext highlighter-rouge">GPtrArray</code>, store array elements in it, and de-allocate memory later, the array lets me set a function to be called on each element when the array itself is freed. Which means I don’t need to individually free the elements manually. I just call <code class="language-plaintext highlighter-rouge">g_ptr_array_unref()</code> and it will also clean up the array contents.</p> <p>Hence, now my code becomes:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> g_autoptr <span class="o">(</span>GHashTable<span class="o">)</span> stream_names <span class="o">=</span>
    g_hash_table_new _full<span class="o">(</span>g_str_hash, g_str_equal, g_free, NULL<span class="o">)</span><span class="p">;</span>

<span class="k">for</span> <span class="o">(</span>guint i <span class="o">=</span> 0<span class="p">;</span> i &lt; self-&gt;streams-&gt;len<span class="p">;</span> i++<span class="o">)</span>
    <span class="o">{</span>
      g_hash_table_add <span class="o">(</span>stream_names,
                        <span class="o">(</span>void <span class="k">*</span><span class="o">)</span>modulemd_module_stream_get_stream_name <span class="o">(</span>
                          g_ptr_array_index <span class="o">(</span>self-&gt;streams, i<span class="o">)))</span><span class="p">;</span>
    <span class="o">}</span>
</code></pre></div></div> <ol> <li> <p><code class="language-plaintext highlighter-rouge">g_hash_table_new_full()</code> allows to create and allocate memory for a hash table container. <code class="language-plaintext highlighter-rouge">g_str_equal</code> specifies that the keys of this hash table need to be unique. <code class="language-plaintext highlighter-rouge">g_free</code> de-allocates memory for the keys. Since we don’t have values for keys, <code class="language-plaintext highlighter-rouge">NULL</code> is provided as no memory de-allocation is required.</p> </li> <li> <p>By using <code class="language-plaintext highlighter-rouge">g_autoptr()</code>, it will cause the compiler to automatically call <code class="language-plaintext highlighter-rouge">g_hash_table_unref()</code> on it when it goes out of scope.</p> </li> </ol> <p>One problem solved!</p> <p>And now we come to a second, BIGGER problem! My next failure point was that I was getting an error message for a function I wasn’t even using! I couldn’t even trace it back to how this function was being called. That’s when Stephan decided to walk me through this hurdle together.</p> <h3 id="reproducing-the-error">Reproducing the error</h3> <p>Observations, assumptions, and steps along the way:</p> <ol> <li> <p>Error messages may be coming from another test. The logs sometimes show expected failures, such as tests to make sure we gracefully handle bad input.</p> </li> <li>Ran just the new test, so we don’t have to debug any of the other tests. <div class="language-sh highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>meson <span class="nb">test</span> <span class="nt">--print-errorlogs</span> module_v2_debug <span class="nt">--test-args</span> <span class="s2">"-p /modulemd/v2/module/stream_names"</span>
</code></pre></div> </div> <p>There was no mention of the assertion failure. That’s because that error comes from a different test.</p> </li> <li>Next, we ran the Valgrind checks. These checks detect any kinds of memory leaks and runtime errors. <div class="language-sh highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>meson <span class="nb">test</span> <span class="nt">--wrap</span><span class="o">=</span><span class="s2">"valgrind --leak-check=full"</span> <span class="nt">--print-errorlogs</span> module_v2_debug <span class="nt">--test-args</span> <span class="s2">"-p /modulemd/v2/module/stream_names"</span>
</code></pre></div> </div> <p>The error logs were clearly divided into 3 distinct sections:</p> <ul> <li>The location the error was detected.</li> <li>The location where the memory being accessed was previously freed.</li> <li>The location where it was originally allocated.</li> </ul> </li> </ol> <p>The output was:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>free<span class="o">()</span>: double free detected <span class="k">in </span>tcache 2
invalid free<span class="o">()</span> detected
</code></pre></div></div> <p>This meant that there were no memory <em>leaks</em>, but there were memory <em>errors</em>. We need to have the same number of free()/unref() calls as we do allocations/ref()s. But somewhere, <strong>an extra free() was being called for memory that was already freed!</strong></p> <p>Now that the exact error was detected, it was time to tackle it!</p> <h3 id="transcending-towards-nirvana">Transcending towards Nirvana</h3> <p>Coming back to this piece of code:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> g_autoptr <span class="o">(</span>GHashTable<span class="o">)</span> stream_names <span class="o">=</span>
    g_hash_table_new _full<span class="o">(</span>g_str_hash, g_str_equal, g_free, NULL<span class="o">)</span><span class="p">;</span>
</code></pre></div></div> <p>In the function <code class="language-plaintext highlighter-rouge">g_hash_table_new_full()</code>:</p> <ol> <li>There were no values. Hence the <code class="language-plaintext highlighter-rouge">NULL</code>.</li> <li>But keys needed a way to get freed. Hence, the <code class="language-plaintext highlighter-rouge">g_free()</code> on each key.</li> <li>But because we’re using <code class="language-plaintext highlighter-rouge">g_autoptr()</code>, it will free it on its own. Hence, that’s a double free.</li> </ol> <p>So, to correct the error, in the function <code class="language-plaintext highlighter-rouge">g_hash_table_new_full()</code> I assigned <code class="language-plaintext highlighter-rouge">NULL</code> to both the ways of freeing the keys and values.</p> <p><strong>However, the solution was right but my reason was WRONG.</strong></p> <p>This approach is correct and makes sense <strong>if the hash table owns the memory of its keys</strong>. However, when I added the keys with <code class="language-plaintext highlighter-rouge">g_hash_table_add()</code>, I added the return value of <code class="language-plaintext highlighter-rouge">modulemd_module_stream_get_stream_name()</code> to it directly. Looking at the definition of <code class="language-plaintext highlighter-rouge">modulemd_module_stream_get_stream_name()</code>, its <code class="language-plaintext highlighter-rouge">transfer</code> value was <code class="language-plaintext highlighter-rouge">none</code>. This means that the function doesn’t transfer any ownership of elements, but only their values. So the caller must not <code class="language-plaintext highlighter-rouge">free()</code> it.</p> <p>There are wo ways of resolving this problem:</p> <ol> <li> <p>You can <code class="language-plaintext highlighter-rouge">g_strdup()</code> the string into the GHashTable, making a copy of it that you can free. Copying the memory and then allowing the GHashTable to free it is safer if there’s a chance that the memory it’s pointing to could be changed before you need it for something. But it comes at the performance cost of having to do a memory allocation.</p> </li> <li> <p>You can drop the free function from the hash initialization.</p> </li> </ol> <p>So the next question: <strong>Where do we use the stream names in this function?</strong></p> <p>We add them to the <code class="language-plaintext highlighter-rouge">GHashtable</code> and then consume those keys to create an ordered set. By looking at the implementation of <code class="language-plaintext highlighter-rouge">modulemd_ordered_str_keys_as_strv()</code>, we notice:</p> <ol> <li> <p>It explicitly makes a <code class="language-plaintext highlighter-rouge">g_strdup()</code> of the strings when adding them to the array.</p> </li> <li> <p>So the data coming back from <code class="language-plaintext highlighter-rouge">modulemd_ordered_str_keys()</code> is not pointing at the original GHashTable internal values, but has its own memory.</p> </li> <li> <p>This means that <code class="language-plaintext highlighter-rouge">modulemd_module_get_stream_names_as_strv()</code> can safely return it as-is, because it’s not coupled to the stream_names GHashTable <em>or</em> the underlying ModuleStream object.</p> </li> <li> <p>It’s fresh and can be passed back as <code class="language-plaintext highlighter-rouge">(transfer full)</code> safely.</p> </li> <li> <p>So, since that function is returning memory that is fully self-contained, it’s safe to return it. Since nothing will change it underneath us and the API consumer can hold onto it however long they need to.</p> </li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GPtrArray <span class="k">*</span>
modulemd_ordered_str_keys <span class="o">(</span>GHashTable <span class="k">*</span>htable, GCompareFunc compare_func<span class="o">)</span>
<span class="o">{</span>
  ...

  <span class="k">while</span> <span class="o">(</span>g_hash_table_iter_next <span class="o">(</span>&amp;iter, &amp;key, NULL<span class="o">))</span>
    <span class="o">{</span>
      g_ptr_array_add <span class="o">(</span>keys, g_strdup <span class="o">((</span>const gchar <span class="k">*</span><span class="o">)</span>key<span class="o">))</span><span class="p">;</span>
    <span class="o">}</span>
  ...

  <span class="k">return </span>keys<span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div> <p>Hence, since we already have a generalized layer that makes a copy and returns a fully self-contained value, we wouldn’t need to make a copy in our <code class="language-plaintext highlighter-rouge">get_stream_names()</code> method. And so making the copy there would be harmless but wasteful. As a general policy, if you’re ever <em>unsure</em> if the memory is going to change on you, make the copy. As a general policy, if you’re ever <em>unsure</em> if the memory is going to change on you, make the copy. But in this case, we can prove that it won’t, so we don’t need to.</p> <p>With this analysis, we reach to the conclusion that the first solution is good enough (assigning NULL for freeing values). To which Stephan replied:</p> <blockquote> <sgallagh> Not just "good enough" but, as we have just explored, it's the best answer! </sgallagh> </blockquote> <p>Hence, my final method looked like this!</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GStrv
modulemd_module_get_stream_names_as_strv <span class="o">(</span>ModulemdModule <span class="k">*</span>self<span class="o">)</span>
<span class="o">{</span>
  g_return_val_if_fail <span class="o">(</span>MODULEMD_IS_MODULE <span class="o">(</span>self<span class="o">)</span>, NULL<span class="o">)</span><span class="p">;</span>

  <span class="k">if</span> <span class="o">(!</span>self-&gt;streams<span class="o">)</span>
    <span class="k">return </span>NULL<span class="p">;</span>

  g_autoptr <span class="o">(</span>GHashTable<span class="o">)</span> stream_names <span class="o">=</span>
    g_hash_table_new <span class="o">(</span>g_str_hash, g_str_equal<span class="o">)</span><span class="p">;</span>

  <span class="k">for</span> <span class="o">(</span>guint i <span class="o">=</span> 0<span class="p">;</span> i &lt; self-&gt;streams-&gt;len<span class="p">;</span> i++<span class="o">)</span>
    <span class="o">{</span>
      g_hash_table_add <span class="o">(</span>stream_names,
                        <span class="o">(</span>void <span class="k">*</span><span class="o">)</span>modulemd_module_stream_get_stream_name <span class="o">(</span>
                          g_ptr_array_index <span class="o">(</span>self-&gt;streams, i<span class="o">)))</span><span class="p">;</span>
    <span class="o">}</span>

  <span class="k">return </span>modulemd_ordered_str_keys_as_strv <span class="o">(</span>stream_names<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="fin">Fin.</h3> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/outreachy-week-7/">Season @ Fedora Modularity</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/mentorship/">Seeking mentors help navigate the Industry</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2017/my-milky-way/">My Milky Way</a> </li> <div id="giscus_thread" style="max-width: 1200px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"OrionStar25/orionstar25.github.io","data-repo-id":"R_kgDOK7Nn4Q","data-category":"Announcements","data-category-id":"DIC_kwDOK7Nn4c4Ce3KD","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Niharika Shrivastava. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>