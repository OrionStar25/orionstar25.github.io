<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Federated Fine-Tuning of LLMs with Private Data | Niharika Shrivastava</title> <meta name="author" content="Niharika Shrivastava"> <meta name="description" content=""> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, niharika-shrivastava"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%98%AF%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://orionstar25.github.io/blog/2024/fl-challenge-day-3/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Niharika¬†</span>Shrivastava</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">opensource</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/presentations/">presentations</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/contributions/">contributions</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/repositories/">github</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/checklist/">my dynamic checklist</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Federated Fine-Tuning of LLMs with Private Data</h1> <p class="post-meta">November 23, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a> ¬† ¬∑ ¬† <a href="/blog/tag/opensource"> <i class="fa-solid fa-hashtag fa-sm"></i> opensource</a> ¬† <a href="/blog/tag/ai"> <i class="fa-solid fa-hashtag fa-sm"></i> ai</a> ¬† <a href="/blog/tag/federated-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> federated-learning</a> ¬† <a href="/blog/tag/openmined"> <i class="fa-solid fa-hashtag fa-sm"></i> openmined</a> ¬† <a href="/blog/tag/challenge"> <i class="fa-solid fa-hashtag fa-sm"></i> challenge</a> ¬† <a href="/blog/tag/data-privacy"> <i class="fa-solid fa-hashtag fa-sm"></i> data-privacy</a> ¬† <a href="/blog/tag/trustworthy-ai"> <i class="fa-solid fa-hashtag fa-sm"></i> trustworthy-ai</a> ¬† ¬† ¬∑ ¬† <a href="/blog/category/open-source"> <i class="fa-solid fa-tag fa-sm"></i> open-source</a> ¬† </p> </header> <article class="post-content"> <div id="markdown-content"> <p>It‚Äôs Day 3 of the <a href="https://info.openmined.org/30daysofflcode" rel="external nofollow noopener" target="_blank">#30DaysOfFLCode</a> Challenge by <a href="https://openmined.org/" rel="external nofollow noopener" target="_blank">OpenMined</a> ü•≥!</p> <p>Today I went through a tutorial: <a href="https://learn.deeplearning.ai/courses/intro-to-federated-learning-c2" rel="external nofollow noopener" target="_blank">Federated Fine-Tuning of LLMs with Private Data</a> by <a href="https://learn.deeplearning.ai/" rel="external nofollow noopener" target="_blank">DeepLearning.AI</a> and <a href="https://flower.ai/" rel="external nofollow noopener" target="_blank">Flower Labs</a>.</p> <p>Let‚Äôs quickly learn a few concepts ‚¨áÔ∏è.</p> <h1 id="introduction">Introduction</h1> <p>A lot of private data was able to be extracted and reconstructed from multiple open source LLMs‚Äô pre-training dataset. Federated Learning is the missing piece of LLMs and private data. This is an alternative to conventional LLM fine-tuning, allowing you to avoid:</p> <ul> <li>using closed fune-tuning APIs.</li> <li>copying into a 3rd party cloud resources.</li> </ul> <p>Key strengths of Federated LLM fine-tuning are:</p> <ul> <li>Improved privacy of data</li> <li>Wider range of data sources</li> <li>Tolerable communication overhead.</li> </ul> <h1 id="centralized-llm-fine-tuning">Centralized LLM Fine-Tuning</h1> <p>We would be working with a medical private data scenario, but the concepts can be extended to any industry with private datasets. The idea is that different hospitals have different sets of private data which would be cenrally collected. This entire data will then be used to fine-tune an LLM and the final model will be shared with all the participating hospitals.</p> <p>We are going to use <code class="language-plaintext highlighter-rouge">medAlpaca</code> </p> <ul> <li>an open source collection of medical conversational AI training data and models. It has the following properties:</li> <li>50k training examples</li> <li>includes Q&amp;A pairs</li> <li>variety of medical domain knowledge</li> </ul> <p>peft + lora will be used for fine-tuning </p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataset</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">medalpaca</span><span class="o">/</span><span class="n">medical_meadow_medical_flashcards</span>
<span class="n">model</span><span class="p">:</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">EleutherAI</span><span class="o">/</span><span class="n">pythia</span><span class="o">-</span><span class="mi">70</span><span class="n">m</span>
  <span class="n">quantization</span><span class="p">:</span> <span class="mi">4</span>
  <span class="n">gradient_checkpointing</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">use_fast_tokenizer</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">lora</span><span class="p">:</span>
    <span class="n">peft_lora_r</span><span class="p">:</span> <span class="mi">16</span>
    <span class="n">peft_lora_alpha</span><span class="p">:</span> <span class="mi">64</span>
    <span class="n">target_modules</span><span class="p">:</span> <span class="n">null</span>
<span class="n">train</span><span class="p">:</span>
  <span class="n">save_every_round</span><span class="p">:</span> <span class="mi">5</span>
  <span class="n">seq_length</span><span class="p">:</span> <span class="mi">512</span>
  <span class="n">padding_side</span><span class="p">:</span> <span class="n">left</span>
  <span class="n">training_arguments</span><span class="p">:</span>
    <span class="n">learning_rate</span><span class="p">:</span> <span class="mf">0.0005</span>
    <span class="n">per_device_train_batch_size</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">gradient_accumulation_steps</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">logging_steps</span><span class="p">:</span> <span class="mi">1</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="mi">5</span>
    <span class="n">report_to</span><span class="p">:</span> <span class="n">null</span>
    <span class="n">save_steps</span><span class="p">:</span> <span class="mi">200</span>
    <span class="n">save_total_limit</span><span class="p">:</span> <span class="mi">10</span>
    <span class="n">gradient_checkpointing</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">lr_scheduler_type</span><span class="p">:</span> <span class="n">cosine</span>
</code></pre></div></div> <p>Generic base LLMs imrpove on domain-specific prompts after fine-tuning with private data.</p> <p>mistral-7b fine-tuned with medalpaca is significantly better under medical prompts</p> <p>However, this finetuning is performed centrally. None of the key challenges of private data have been addressed.</p> <ul> <li>privacy</li> <li>regulation</li> <li>data volume</li> </ul> <p>federeated LLM fine-tuning is the answer.</p> <h1 id="federated-llm-fine-tuning">Federated LLM Fine-Tuning</h1> <h1 id="privacy-analysis-of-llms-using-mia">Privacy analysis of LLMs using MIA</h1> <h1 id="references">References</h1> <p>[1] <a href="https://learn.deeplearning.ai/courses/intro-to-federated-learning-c2" rel="external nofollow noopener" target="_blank">https://learn.deeplearning.ai/courses/intro-to-federated-learning-c2</a></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/multi-agents/">Multi-Agents with CrewAI</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/fl-challenge-day-1/">Introduction to Federated Learning</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/fl-challenge-day-2/">Privacy Preserving AI</a> </li> <div id="giscus_thread" style="max-width: 1200px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"OrionStar25/orionstar25.github.io","data-repo-id":"R_kgDOK7Nn4Q","data-category":"Announcements","data-category-id":"DIC_kwDOK7Nn4c4Ce3KD","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2025 Niharika Shrivastava. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>